import{c as De,a as S,l as Be}from"../chunks/Bple36bD.js";import{i as Je}from"../chunks/tszBVZzd.js";import{f as n,b0 as It,az as Ot,C as Ge,D as Nt,b1 as Mt,S as Dt,al as Et,b2 as Bt,b3 as Ht,t as Ft,b4 as Vt,b5 as Ut,b6 as Pt,b7 as Jt,b8 as Kt,b9 as Zt,ba as Yt,bb as Gt,bc as _t,T as Wt,N as tt,bd as Xt,p as He,a_ as K,q as h,v as Fe,F as y,w as T,be as Qt,bf as ge,a as d,m as D,i as de,bg as $e,aL as Ee,l as ze,aK as w,b as e,o as I,aZ as C,bh as Ye,x as c,z as M,y as o,A as oe,bi as pt,aY as gt,bj as Lt,ax as $t,bk as ae,aN as ot,aH as jt,bl as ea,aM as Ct,bm as We,bn as Pe,bo as ta,_ as yt}from"../chunks/G5IqZ6B0.js";import{p as ne,i as V,b as aa}from"../chunks/BL9RboVD.js";import{b as ra,e as Te,i as Me,s as ft,a as ht,p as it,c as ke}from"../chunks/_h1dF3gv.js";import{g as sa,i as lt}from"../chunks/BES3PZGa.js";function na(t,a,r,l){return t!==a&&It(r,Ot(l)),t}function oa(t,a,r,l){return na(t[a]=r,n(()=>t[a]),a,l)}function la(t,a,r,l,s){Ge&&Nt();var g=a.$$slots?.[r],m=!1;g===!0&&(g=a.children,m=!0),g===void 0||g(t,m?()=>l:l)}function kt(t,a,r,l){var s=t.__style;if(Ge||s!==a){var g=ra(a);(!Ge||g!==t.getAttribute("style"))&&(g==null?t.removeAttribute("style"):t.style.cssText=g),t.__style=a}return l}function Rt(t,a,r=!1){if(t.multiple){if(a==null)return;if(!Et(a))return Bt();for(var l of t.options)l.selected=a.includes(at(l));return}for(l of t.options){var s=at(l);if(Ht(s,a)){l.selected=!0;return}}(!r||a!==void 0)&&(t.selectedIndex=-1)}function ia(t){var a=new MutationObserver(()=>{Rt(t,t.__value)});a.observe(t,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),Ft(()=>{a.disconnect()})}function st(t,a,r=a){var l=!0;Mt(t,"change",s=>{var g=s?"[selected]":":checked",m;if(t.multiple)m=[].map.call(t.querySelectorAll(g),at);else{var R=t.querySelector(g)??t.querySelector("option:not([disabled])");m=R&&at(R)}r(m)}),Dt(()=>{var s=a();if(Rt(t,s,l),l&&s===void 0){var g=t.querySelector(":checked");g!==null&&(s=at(g),r(s))}t.__value=s,l=!1}),ia(t)}function at(t){return"__value"in t?t.__value:t.value}const ca=Symbol("is custom element"),ua=Symbol("is html");function Oe(t){if(Ge){var a=!1,r=()=>{if(!a){if(a=!0,t.hasAttribute("value")){var l=t.value;ee(t,"value",null),t.value=l}if(t.hasAttribute("checked")){var s=t.checked;ee(t,"checked",null),t.checked=s}}};t.__on_r=r,Vt(r),Ut()}}function ee(t,a,r,l){var s=da(t);if(Ge&&(s[a]=t.getAttribute(a),a==="src"||a==="srcset"||a==="href"&&t.nodeName==="LINK")){fa(t,a,r??"");return}s[a]!==(s[a]=r)&&(a==="loading"&&(t[Pt]=r),r==null?t.removeAttribute(a):typeof r!="string"&&va(t).includes(a)?t[a]=r:t.setAttribute(a,r))}function da(t){return t.__attributes??={[ca]:t.nodeName.includes("-"),[ua]:t.namespaceURI===Jt}}var xt=new Map;function va(t){var a=xt.get(t.nodeName);if(a)return a;xt.set(t.nodeName,a=[]);for(var r,l=t,s=Element.prototype;s!==l;){r=Yt(l);for(var g in r)r[g].set&&a.push(g);l=Zt(l)}return a}function fa(t,a,r){a==="srcset"&&ba(t,r)||bt(t.getAttribute(a)??"",r)||Kt(a,t.outerHTML.replace(t.innerHTML,t.innerHTML&&"..."),String(r))}function bt(t,a){return t===a?!0:new URL(t,document.baseURI).href===new URL(a,document.baseURI).href}function wt(t){return t.split(",").map(a=>a.trim().split(" ").filter(Boolean))}function ba(t,a){var r=wt(t.srcset),l=wt(a);return l.length===r.length&&l.every(([s,g],m)=>g===r[m][1]&&(bt(r[m][0],s)||bt(s,r[m][0])))}function Ne(t,a,r=a){var l=Gt(),s=new WeakSet;Mt(t,"input",g=>{t.type==="checkbox"&&_t();var m=g?t.defaultValue:t.value;if(m=dt(t)?vt(m):m,r(m),tt!==null&&s.add(tt),l&&m!==(m=a())){var R=t.selectionStart,v=t.selectionEnd;t.value=m??"",v!==null&&(t.selectionStart=R,t.selectionEnd=Math.min(v,t.value.length))}}),(Ge&&t.defaultValue!==t.value||n(a)==null&&t.value)&&(r(dt(t)?vt(t.value):t.value),tt!==null&&s.add(tt)),Wt(()=>{t.type==="checkbox"&&_t();var g=a();if(t===document.activeElement){var m=Xt??tt;if(s.has(m))return}dt(t)&&g===vt(t.value)||t.type==="date"&&!g&&!t.value||g!==t.value&&(t.value=g??"")})}function dt(t){var a=t.type;return a==="number"||a==="range"}function vt(t){return t===""?null:+t}function mt(t,a){var r=t.$$events?.[a.type],l=Et(r)?r.slice():r==null?[]:[r];for(var s of l)s.call(this,a)}nt[y]="src/lib/components/SearchInput.svelte";var pa=S(T('<input class="w-full px-3 py-2 rounded border border-gray-400 dark:border-neutral-700 bg-white dark:bg-neutral-800 text-gray-900 dark:text-white focus:outline-none focus:border-blue-600 transition" type="text" placeholder="Keresés... (pl. név, rang, egységszám, ...)"/>'),nt[y],[[6,0]]);function nt(t,a){De(new.target),He(a,!1,nt);let r=ne(a,"value",12,""),l=ne(a,"onInput",8,()=>{});var s=pa();return Oe(s),Ne(s,r),K("input",s,function(...g){Qt(l,this,g,nt,[11,14])}),h(t,s),Fe({...Be()})}Xe[y]="src/lib/components/RankImage.svelte";var ga=S(T('<img class="inline h-6 w-auto rounded shadow" style="min-width: 32px; max-width: 40px;"/>'),Xe[y],[[18,4]]),ha=S(T('<span style="display:inline-block; min-width:32px; max-width:40px; height:24px;"></span>'),Xe[y],[[27,4]]);function Xe(t,a){De(new.target),He(a,!1,Xe);const r=D();let l=ne(a,"rang",8,"");function s(A){return!A||C(typeof A,"string",!1)?"":`/rendfokozatok/${A.replace(/[Áá]/g,"a").replace(/[Éé]/g,"e").replace(/[Íí]/g,"i").replace(/[ÓóÖöŐő]/g,"o").replace(/[ÚúÜüŰű]/g,"u").replace(/ /g,"").toLowerCase()}.jpeg`}ge(()=>de(l()),()=>{d(r,!!l()&&!l().toLowerCase().includes("akadémista"))}),$e(),Je();var g=Ee(),m=ze(g);{var R=A=>{var G=ga();I((O,U)=>{ee(G,"src",O),ee(G,"alt",l()),ee(G,"data-nev",U)},[()=>(de(l()),n(()=>s(l()))),()=>(de(l()),n(()=>l()?.toLowerCase()||""))]),K("error",G,O=>oa(O.target.style,"display","none","src/​lib/​components/​RankImage.svelte:24:24")),h(A,G)},v=A=>{var G=ha();h(A,G)};w(()=>V(m,A=>{e(r)?A(R):A(v,!1)}),"if",Xe,17,0)}return h(t,g),Fe({...Be()})}const ma=["Akadémista","Őrmester","Törzsőrmester","Főtörzsőrmester","Zászlós","Törzszászlós","Főtörzszászlós","Hadnagy","Főhadnagy","Százados","Őrnagy","Alezredes","Ezredes","Dandártábornok","Vezérőrnagy","Altábornagy"],zt=Object.fromEntries(ma.map((t,a)=>[t.toLowerCase(),a]));function qt(t){return t?typeof t=="string"?t.slice(0,10):t:""}function St(t){if(!t)return 0;const a=qt(t),r=Date.parse(a);return Number.isFinite(r)?r:0}function At(t){return qt(t)}function _a(t){t&&(typeof navigator>"u"||!navigator?.clipboard||navigator.clipboard.writeText(t).catch(()=>{}))}function ya(t,a,r){if(!a)return t;const l=[...t];return a==="Rendfokozat"?l.sort((s,g)=>{const m=zt[s.Rendfokozat?.toLowerCase()??""]??-1,R=zt[g.Rendfokozat?.toLowerCase()??""]??-1;return r?m-R:R-m}):a==="#"||a==="Egységszám"?l.sort((s,g)=>{const m=Number(s[a])||0,R=Number(g[a])||0;return r?m-R:R-m}):["Csatlakozás","Előléptetve","Inaktivitás kezdete"].includes(a)?l.sort((s,g)=>{const m=St(s[a]),R=St(g[a]);return r?m-R:R-m}):l.sort((s,g)=>{const m=(s[a]??"").toString().toLowerCase(),R=(g[a]??"").toString().toLowerCase();return r?m.localeCompare(R):R.localeCompare(m)})}function ka(t){return(t?.[0]??[]).filter(Boolean)}function xa(t,a){return t.slice(1).filter(r=>r?.[1]?.toString().trim()).map(r=>{let l=[...r];l.length===a.length+1&&l.splice(3,1);const s=Object.fromEntries(a.map((g,m)=>[g,l[m]]));return{"#":r[0],...s}})}J[y]="src/lib/components/TableCore.svelte";var wa=S(pt('<path d="M7 10l5 5 5-5H7z"></path>'),J[y],[[33,18]]),za=S(pt('<path d="M7 15l5-5 5 5H7z"></path>'),J[y],[[35,18]]),Sa=S(pt('<svg class="h-3 w-3" viewBox="0 0 20 20" fill="currentColor"><!></svg>'),J[y],[[31,14]]),Aa=S(T('<th class="sticky top-0 z-10 select-none border-y border-blue-700 bg-blue-700 px-4 py-3 font-semibold uppercase text-white"><span class="flex items-center gap-1"> <!></span></th>'),J[y],[[23,8,[[28,10]]]]),Ta=S(T('<td class="whitespace-nowrap px-4 py-2 text-left align-middle"><div class="flex items-center gap-2"><!> <span class="font-semibold"> </span></div></td>'),J[y],[[51,14,[[52,16,[[54,18]]]]]]),Ma=S(T('<td class="px-4 py-2 text-left"> </td>'),J[y],[[59,14]]),Ea=S(T('<span class="inline-block rounded-full bg-green-600/90 px-3 py-1 text-xs font-semibold text-white">Aktív</span>'),J[y],[[64,18]]),La=S(T('<span class="inline-block rounded-full bg-red-600/90 px-3 py-1 text-xs font-semibold text-white">Inaktív</span>'),J[y],[[66,18]]),ja=S(T('<span class="text-xs text-gray-500"> </span>'),J[y],[[68,18]]),Ca=S(T('<td class="px-4 py-2 text-center"><!></td>'),J[y],[[62,14]]),Ra=S(T('<td class="px-4 py-2 text-center"> </td>'),J[y],[[73,14]]),qa=S(T('<td class="group relative cursor-pointer whitespace-nowrap px-4 py-2 text-center"><span> </span> <span class="pointer-events-none absolute -top-7 left-1/2 -translate-x-1/2 rounded bg-black/90 px-2 py-1 text-xs text-white opacity-0 shadow transition group-hover:opacity-100">Másolás!</span></td>'),J[y],[[76,14,[[77,16],[78,16]]]]),Ia=S(T('<td class="px-2 py-2 text-center"><div class="flex justify-center gap-3"><button title="Módosítás" class="inline-flex items-center justify-center rounded-full bg-blue-700 p-1 transition hover:bg-blue-600"><svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.232 5.232l3.536 3.536M9 13l6.364-6.364a2 2 0 112.828 2.828L11.828 15.828a2 2 0 01-2.828 0L5 11.828a2 2 0 010-2.828l6.364-6.364z"></path></svg></button> <button title="Törlés" class="inline-flex items-center justify-center rounded-full bg-red-700 p-1 transition hover:bg-red-600"><svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6M9 7V4a1 1 0 011-1h4a1 1 0 011 1v3m-6 0h6"></path></svg></button></div></td>'),J[y],[[84,14,[[85,16,[[87,18,[[88,20,[[89,22]]]]],[93,18,[[94,20,[[95,22]]]]]]]]]]),Oa=S(T("<td> </td>"),J[y],[[102,14]]),Na=S(T('<tr class="transition odd:bg-neutral-900 even:bg-neutral-950 hover:bg-blue-900/40"></tr>'),J[y],[[48,8]]),Da=S(T('<tr><td class="py-10 text-center text-gray-400">Nincs találat.</td></tr>'),J[y],[[115,6,[[116,8]]]]),Ba=S(T('<table class="w-full min-w-[1100px] table-fixed border-separate border-spacing-0"><thead><tr></tr></thead><tbody><!></tbody></table>'),J[y],[[19,0,[[20,2,[[21,4]]],[45,2]]]]);function J(t,a){De(new.target),He(a,!1,J);let r=ne(a,"columns",24,()=>[]),l=ne(a,"records",24,()=>[]),s=ne(a,"sortKey",8,""),g=ne(a,"sortAsc",8,!1);const m=Ye(),R=(f,x)=>m(f,x);function v(f){R("sort",f)}function A(f){R("edit",f)}function G(f){R("delete",f)}Je();var O=Ba(),U=c(O),Z=c(U);w(()=>Te(Z,5,r,Me,(f,x)=>{var $=Aa(),le=c($),j=c(le),u=M(j);{var i=k=>{var te=Sa(),ye=c(te);{var he=z=>{var b=wa();h(z,b)},se=z=>{var b=za();h(z,b)};w(()=>V(ye,z=>{g()?z(he):z(se,!1)}),"if",J,32,16)}o(te),h(k,te)};w(()=>V(u,k=>{de(s()),e(x),n(()=>C(s(),e(x).key))&&k(i)}),"if",J,30,12)}o(le),o($),I(()=>{kt($,`width:${e(x),n(()=>e(x).width)??""};text-align:${e(x),n(()=>e(x).align||"left")??""}`),kt(le,`justify-content:${e(x),n(()=>C(e(x).align,"center")?"center":"flex-start")??""};`),oe(j,`${e(x),n(()=>e(x).label)??""} `)}),K("click",$,()=>v(e(x).key)),h(f,$)}),"each",J,22,6),o(Z),o(U);var N=M(U),H=c(N);{var F=f=>{var x=Ee(),$=ze(x);w(()=>Te($,1,l,Me,(le,j)=>{var u=Na();w(()=>Te(u,5,r,Me,(i,k)=>{var te=Ee(),ye=ze(te);{var he=z=>{var b=Ta(),_=c(b),Y=c(_);w(()=>Xe(Y,{get rang(){return e(j),n(()=>e(j).Rendfokozat)}}),"component",J,53,18,{componentTag:"RankImage"});var X=M(Y,2),P=c(X,!0);o(X),o(_),o(b),I(()=>oe(P,(e(j),n(()=>e(j).Rendfokozat)))),h(z,b)},se=z=>{var b=Ee(),_=ze(b);{var Y=P=>{var q=Ma(),Q=c(q,!0);o(q),I(()=>oe(Q,(e(j),e(k),n(()=>e(j)[e(k).key])))),h(P,q)},X=P=>{var q=Ee(),Q=ze(q);{var W=B=>{var ce=Ca(),Ve=c(ce);{var Re=pe=>{var me=Ea();h(pe,me)},Ze=pe=>{var me=Ee(),Le=ze(me);{var qe=_e=>{var ue=La();h(_e,ue)},Ke=_e=>{var ue=ja(),Ae=c(ue,!0);o(ue),I(()=>oe(Ae,(e(j),e(k),n(()=>e(j)[e(k).key])))),h(_e,ue)};w(()=>V(Le,_e=>{e(j),e(k),n(()=>C(e(j)[e(k).key]?.trim().toLowerCase(),"inaktív"))?_e(qe):_e(Ke,!1)},!0),"if",J,65,16)}h(pe,me)};w(()=>V(Ve,pe=>{e(j),e(k),n(()=>C(e(j)[e(k).key]?.trim().toLowerCase(),"aktív"))?pe(Re):pe(Ze,!1)}),"if",J,63,16)}o(ce),h(B,ce)},re=B=>{var ce=Ee(),Ve=ze(ce);{var Re=pe=>{var me=Ra(),Le=c(me,!0);o(me),I(qe=>oe(Le,qe),[()=>(de(At),e(j),e(k),n(()=>At(e(j)[e(k).key])))]),h(pe,me)},Ze=pe=>{var me=Ee(),Le=ze(me);{var qe=_e=>{var ue=qa(),Ae=c(ue),je=c(Ae,!0);o(Ae),gt(2),o(ue),I(()=>oe(je,(e(j),e(k),n(()=>e(j)[e(k).key])))),K("click",ue,()=>_a(e(j)[e(k).key])),h(_e,ue)},Ke=_e=>{var ue=Ee(),Ae=ze(ue);{var je=Ce=>{var p=Ia(),E=c(p),ie=c(E),xe=M(ie,2);o(E),o(p),K("click",ie,()=>A(e(j))),K("click",xe,()=>G(e(j))),h(Ce,p)},et=Ce=>{var p=Oa();let E;var ie=c(p,!0);o(p),I(xe=>{E=ft(p,1,"px-4 py-2",null,E,xe),oe(ie,(e(j),e(k),n(()=>e(j)[e(k).key])))},[()=>({"text-left":C(e(k).align,"left"),"text-center":C(e(k).align,"center")||!e(k).align,"text-right":C(e(k).align,"right")})]),h(Ce,p)};w(()=>V(Ae,Ce=>{e(k),n(()=>C(e(k).key,"__actions"))?Ce(je):Ce(et,!1)},!0),"if",J,83,12)}h(_e,ue)};w(()=>V(Le,_e=>{e(k),n(()=>C(e(k).key,"Telefonszám")||C(e(k).key,"discord ID"))?_e(qe):_e(Ke,!1)},!0),"if",J,75,12)}h(pe,me)};w(()=>V(Ve,pe=>{e(k),n(()=>C(e(k).key,"Csatlakozás")||C(e(k).key,"Előléptetve")||C(e(k).key,"Inaktivitás kezdete"))?pe(Re):pe(Ze,!1)},!0),"if",J,72,12)}h(B,ce)};w(()=>V(Q,B=>{e(k),n(()=>C(e(k).key,"Aktivitás"))?B(W):B(re,!1)},!0),"if",J,61,12)}h(P,q)};w(()=>V(_,P=>{e(k),n(()=>C(e(k).key,"Név"))?P(Y):P(X,!1)},!0),"if",J,58,12)}h(z,b)};w(()=>V(ye,z=>{e(k),n(()=>C(e(k).key,"Rendfokozat"))?z(he):z(se,!1)}),"if",J,50,12)}h(i,te)}),"each",J,49,10),o(u),h(le,u)}),"each",J,47,6),h(f,x)},L=f=>{var x=Da(),$=c(x);o(x),I(()=>ee($,"colspan",(de(r()),n(()=>r().length)))),h(f,x)};w(()=>V(H,f=>{de(l()),n(()=>l().length>0)?f(F):f(L,!1)}),"if",J,46,4)}return o(N),o(O),h(t,O),Fe({...Be()})}ct[y]="src/lib/components/StaffTable.svelte";function ct(t,a){De(new.target),He(a,!1,ct);const r=D(),l=D(),s=D(),g=D(),m=D(),R=D(),v=D();let A=ne(a,"data",24,()=>[]),G=ne(a,"userRole",8,null),O=ne(a,"forceActions",8,!1);const U=Ye(),Z=[{key:"#",label:"#",width:"40px",align:"center"},{key:"Név",label:"Név",width:"180px",align:"left"},{key:"Rendfokozat",label:"Rendfokozat",width:"160px",align:"left"},{key:"Beosztás",label:"Beosztás",width:"130px",align:"center"},{key:"Osztály",label:"Osztály",width:"130px",align:"center"},{key:"Egységszám",label:"Egységszám",width:"90px",align:"center"},{key:"Telefonszám",label:"Telefon",width:"120px",align:"center"},{key:"Csatlakozás",label:"Csatlakozás",width:"100px",align:"center"},{key:"Előléptetve",label:"Előléptetve",width:"100px",align:"center"},{key:"Aktivitás",label:"Státusz",width:"110px",align:"center"},{key:"Inaktivitás kezdete",label:"Inaktívóta",width:"110px",align:"center"},{key:"Helikopteres Vizsga",label:"Heli V.",width:"100px",align:"center"},{key:"discord ID",label:"Discord ID",width:"170px",align:"center"}];function N(f){if(!f)return[];if(C(typeof f,"object")&&!Array.isArray(f)){const x=[];return f.role&&x.push(f.role),f.roles&&x.push(...Array.isArray(f.roles)?f.roles:[f.roles]),x.map(String)}return Array.isArray(f)?f.map(String):[String(f)]}let H=D("Rendfokozat"),F=D(!1);function L(f){const x=f.detail;C(e(H),x)?d(F,!e(F)):(d(H,x),d(F,!1))}return ge(()=>de(A()),()=>{d(r,ka(A()))}),ge(()=>(de(A()),e(r)),()=>{d(l,xa(A(),e(r)))}),ge(()=>de(G()),()=>{d(s,N(G()).map(f=>f.toLowerCase().trim()))}),ge(()=>e(s),()=>{d(g,e(s).some(f=>C(f,"admin")||C(f,"hr")||f.includes("admin")||f.includes("hr")||f.includes("human resources")))}),ge(()=>(de(O()),e(g)),()=>{d(m,O()||e(g))}),ge(()=>e(m),()=>{d(R,e(m)?[...Z,{key:"__actions",label:"",width:"80px",align:"center"}]:Z)}),ge(()=>(e(l),e(H),e(F)),()=>{d(v,ya(e(l),e(H),e(F)))}),$e(),Je(),w(()=>J(t,{get columns(){return e(R)},get records(){return e(v)},get sortKey(){return e(H)},get sortAsc(){return e(F)},$$events:{sort:L,edit:f=>U("edit",f.detail),delete:f=>U("delete",f.detail)}}),"component",ct,69,0,{componentTag:"TableCore"}),Fe({...Be()})}const rt=$t(null);Lt(rt,t=>!!t);Lt(rt,t=>t?.role??null);async function Tt(){try{const t=await fetch("/api/auth/me");if(!t.ok){rt.set(null);return}const a=await t.json();rt.set(a.user??null)}catch{rt.set(null)}}Se[y]="src/lib/components/AuthModal.svelte";var Ha=S(T('<div class="text-red-400 mb-2"> </div>'),Se[y],[[113,12]]),Fa=S(T('<form><input class="w-full border border-gray-700 bg-neutral-800 text-white rounded px-3 py-2 mb-3" type="text" placeholder="Felhasználónév" required/> <input class="w-full border border-gray-700 bg-neutral-800 text-white rounded px-3 py-2 mb-3" type="password" placeholder="Jelszó" required/> <!> <button class="w-full bg-blue-700 hover:bg-blue-800 text-white font-bold py-2 px-4 rounded" type="submit"><!></button></form>'),Se[y],[[109,8,[[110,10],[111,10],[115,10]]]]),Va=S(T('<div class="text-red-400 mb-2"> </div>'),Se[y],[[126,12]]),Ua=S(T('<form><input class="w-full border border-gray-700 bg-neutral-800 text-white rounded px-3 py-2 mb-3" type="text" placeholder="Felhasználónév" required/> <input class="w-full border border-gray-700 bg-neutral-800 text-white rounded px-3 py-2 mb-3" type="password" placeholder="Jelszó" required/> <input class="w-full border border-gray-700 bg-neutral-800 text-white rounded px-3 py-2 mb-3" type="password" placeholder="Jelszó újra" required/> <!> <button class="w-full bg-blue-700 hover:bg-blue-800 text-white font-bold py-2 px-4 rounded" type="submit"><!></button></form>'),Se[y],[[121,8,[[122,10],[123,10],[124,10],[128,10]]]]),Pa=S(T('<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/60"><div class="bg-neutral-900 rounded-lg shadow-lg w-full max-w-md p-8 relative"><button class="absolute top-2 right-2 text-gray-400 hover:text-white">&times;</button> <div class="flex mb-6"><button>Belépés</button> <button>Regisztráció</button></div> <!></div></div>'),Se[y],[[91,2,[[92,4,[[93,6],[94,6,[[95,8],[100,8]]]]]]]]);function Se(t,a){De(new.target),He(a,!1,Se);let r=ne(a,"show",12,!1),l=D("login"),s=D(""),g=D(""),m=D(""),R="user",v=D(""),A=D(!1);const G=Ye();function O(){r(!1),d(v,""),d(A,!1),G("close")}async function U(){d(v,""),d(A,!0);const L=(await ae(fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e(s),password:e(g)})})))(),f=(await ae(L.json()))();if(d(A,!1),!L.ok||C(f?.success,!1)){ke(e(v),"error");return}f.success?((await ae(Tt()))(),G("login"),O(),sa("/")):ke(e(v),"error")}async function Z(){if(d(v,""),C(e(g),e(m),!1)){d(v,"A jelszavak nem egyeznek!"),ke(e(v),"error");return}d(A,!0);const L=(await ae(fetch("/api/auth/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e(s),password:e(g),role:R})})))(),f=(await ae(L.json()))();d(A,!1),f.success?((await ae(Tt()))(),d(l,"login")):(d(l,"register"),ke(e(v),"error"))}Je();var N=Ee(),H=ze(N);{var F=L=>{var f=Pa(),x=c(f),$=c(x),le=M($,2),j=c(le);let u;var i=M(j,2);let k;o(le);var te=M(le,2);{var ye=se=>{var z=Fa(),b=c(z);Oe(b);var _=M(b,2);Oe(_);var Y=M(_,2);{var X=re=>{var B=Ha(),ce=c(B,!0);o(B),I(()=>oe(ce,e(v))),h(re,B)};w(()=>V(Y,re=>{e(v)&&re(X)}),"if",Se,112,10)}var P=M(Y,2),q=c(P);{var Q=re=>{var B=ot("Belépés...");h(re,B)},W=re=>{var B=ot("Belépés");h(re,B)};w(()=>V(q,re=>{e(A)?re(Q):re(W,!1)}),"if",Se,116,12)}o(P),o(z),I(()=>P.disabled=e(A)),Ne(b,()=>e(s),re=>d(s,re)),Ne(_,()=>e(g),re=>d(g,re)),K("submit",z,it(U)),h(se,z)},he=se=>{var z=Ua(),b=c(z);Oe(b);var _=M(b,2);Oe(_);var Y=M(_,2);Oe(Y);var X=M(Y,2);{var P=B=>{var ce=Va(),Ve=c(ce,!0);o(ce),I(()=>oe(Ve,e(v))),h(B,ce)};w(()=>V(X,B=>{e(v)&&B(P)}),"if",Se,125,10)}var q=M(X,2),Q=c(q);{var W=B=>{var ce=ot("Regisztráció...");h(B,ce)},re=B=>{var ce=ot("Regisztráció");h(B,ce)};w(()=>V(Q,B=>{e(A)?B(W):B(re,!1)}),"if",Se,129,12)}o(q),o(z),I(()=>q.disabled=e(A)),Ne(b,()=>e(s),B=>d(s,B)),Ne(_,()=>e(g),B=>d(g,B)),Ne(Y,()=>e(m),B=>d(m,B)),K("submit",z,it(Z)),h(se,z)};w(()=>V(te,se=>{C(e(l),"login")?se(ye):se(he,!1)}),"if",Se,107,6)}o(x),o(f),I((se,z)=>{u=ft(j,1,"flex-1 py-2 font-bold rounded-l-lg transition-colors",null,u,se),k=ft(i,1,"flex-1 py-2 font-bold rounded-r-lg transition-colors",null,k,z)},[()=>({"bg-blue-700":C(e(l),"login"),"bg-neutral-800":C(e(l),"login",!1)}),()=>({"bg-blue-700":C(e(l),"register"),"bg-neutral-800":C(e(l),"register",!1)})]),K("click",$,O),K("click",j,()=>{d(l,"login"),d(v,"")}),K("click",i,()=>{d(l,"register"),d(v,"")}),K("click",x,ht(function(se){mt.call(this,a,se)})),K("click",f,O),h(L,f)};w(()=>V(H,L=>{r()&&L(F)}),"if",Se,88,0)}return h(t,N),Fe({...Be()})}Qe[y]="src/lib/components/Modal.svelte";var Ja=S(T('<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm transition-opacity animate-fade-in svelte-1ftr5tc" aria-modal="true" role="dialog" tabindex="-1"><div class="absolute inset-0" aria-hidden="true"></div>  <div class="relative bg-neutral-900 rounded-lg shadow-lg max-w-lg w-full mx-4 p-0 animate-fade-in-up outline-none svelte-1ftr5tc" role="document" tabindex="0"><div class="flex items-center justify-between px-6 py-4 border-b border-neutral-700"><h2 class="text-xl font-bold text-white" id="modal-title"> </h2> <button type="button" class="ml-4 p-1 rounded hover:bg-neutral-800 text-neutral-300 hover:text-white transition" aria-label="Bezárás"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></div> <div class="px-6 py-4"><!></div></div></div>'),Qe[y],[[58,2,[[59,4],[63,4,[[70,6,[[71,8],[72,8,[[73,10,[[73,120]]]]]]],[76,6]]]]]]);function Qe(t,a){De(new.target),He(a,!1,Qe);let r=ne(a,"show",8,!1),l=ne(a,"title",8,""),s=ne(a,"onClose",8,()=>{});const g=Ye();let m=D(),R,v;function A(){s()(),g("close")}function G(N){if(C(N.key,"Escape")&&(N.preventDefault(),A()),C(N.key,"Tab")&&r()&&e(m)){const H=e(m).querySelectorAll('a, button, textarea, input, select, [tabindex]:not([tabindex="-1"])'),F=H[0],L=H[H.length-1];!N.shiftKey&&C(document.activeElement,L)?(N.preventDefault(),F.focus()):N.shiftKey&&C(document.activeElement,F)&&(N.preventDefault(),L.focus())}}jt(()=>(r()&&(R=document.activeElement,setTimeout(()=>e(m)?.focus?.(),0)),window.addEventListener("keydown",G),v=()=>{window.removeEventListener("keydown",G),R?.focus?.()},v)),ea(()=>{v?.()}),Je();var O=Ee(),U=ze(O);{var Z=N=>{var H=Ja(),F=c(H),L=M(F,2),f=c(L),x=c(f),$=c(x,!0);o(x);var le=M(x,2);o(f);var j=M(f,2),u=c(j);la(u,a,"default",{}),o(j),o(L),aa(L,i=>d(m,i),()=>e(m)),o(H),I(()=>oe($,l())),K("click",F,A),K("click",le,A),K("click",L,ht(function(i){mt.call(this,a,i)})),h(N,H)};w(()=>V(U,N=>{r()&&N(Z)}),"if",Qe,56,0)}return h(t,O),Fe({...Be()})}ve[y]="src/lib/components/CreateModal.svelte";var Ka=S(T("<option> </option>"),ve[y],[[64,18]]),Za=S(T('<select class="select select-bordered w-full bg-neutral-800 border-neutral-600 text-white"><option disabled hidden>Válassz…</option><!></select>'),ve[y],[[55,14,[[62,16]]]]),Ya=S(T('<input class="input input-bordered w-full bg-neutral-800 border-neutral-600 text-white" autocomplete="off"/>'),ve[y],[[68,14]]),Ga=S(T('<div><label class="mb-1 block font-semibold"> </label> <!></div>'),ve[y],[[51,10,[[52,12]]]]),Wa=S(T("<option> </option>"),ve[y],[[98,18]]),Xa=S(T('<select class="select select-bordered w-full bg-neutral-800 border-neutral-600 text-white"><option disabled hidden>Válassz…</option><!></select>'),ve[y],[[89,14,[[96,16]]]]),Qa=S(T('<input class="input input-bordered w-full bg-neutral-800 border-neutral-600 text-white" autocomplete="off"/>'),ve[y],[[102,14]]),$a=S(T('<div><label class="mb-1 block font-semibold"> </label> <!></div>'),ve[y],[[85,10,[[86,12]]]]),er=S(T('<span class="loading loading-spinner loading-sm mr-2"></span>'),ve[y],[[122,10]]),tr=S(T('<form class="space-y-4"><fieldset class="flex flex-wrap gap-6"><div class="flex-1 min-w-[220px] space-y-4"></div> <div class="flex-1 min-w-[220px] space-y-4"></div></fieldset> <div class="flex justify-end gap-2 pt-2"><button type="button" class="btn btn-error">Mégsem</button> <button type="submit" class="btn btn-success"><!> Létrehozás</button></div></form>'),ve[y],[[47,2,[[48,4,[[49,6],[83,6]]],[118,4,[[119,6],[120,6]]]]]]);function ve(t,a){De(new.target),He(a,!1,ve);let r=ne(a,"show",8,!1),l=ne(a,"title",8,"Új rekord létrehozása"),s=ne(a,"fields",24,()=>[]),g=ne(a,"initial",24,()=>({})),m=ne(a,"isLoading",8,!1);const R=Ye();let v=D({}),A=D(!1);function G(U){U.preventDefault();for(const Z of s())if(Z.required&&!String(e(v)[Z.key]??"").trim()){document.getElementById(`${Z.key}-create`)?.focus();return}R("submit",{...e(v)})}const O=(U=[])=>U.map(Z=>C(typeof Z,"string")?{value:Z,label:Z}:Z);return ge(()=>(de(r()),e(A),e(v),de(s()),de(g())),()=>{r()&&!e(A)&&(d(A,!0),d(v,Object.fromEntries(s().map(U=>[U.key,""]))),d(v,{...e(v),...g()}))}),ge(()=>(de(r()),e(A)),()=>{!r()&&e(A)&&d(A,!1)}),$e(),Je(),w(()=>Qe(t,{get show(){return r()},get title(){return l()},$$events:{close:()=>R("close")},children:Ct(ve,(U,Z)=>{var N=tr(),H=c(N),F=c(H);w(()=>Te(F,5,()=>(de(s()),n(()=>s().slice(0,Math.ceil(s().length/2)))),Me,(u,i)=>{var k=Ga(),te=c(k),ye=c(te,!0);o(te);var he=M(te,2);{var se=b=>{var _=Za();I(()=>{e(v),We(()=>{e(i)})});var Y=c(_);Y.value=Y.__value="";var X=M(Y);w(()=>Te(X,1,()=>(e(i),n(()=>O(e(i).options))),Me,(P,q)=>{var Q=Ka(),W=c(Q,!0);o(Q);var re={};I(()=>{oe(W,(e(q),n(()=>e(q).label))),re!==(re=(e(q),n(()=>e(q).value)))&&(Q.value=(Q.__value=(e(q),n(()=>e(q).value)))??"")}),h(P,Q)}),"each",ve,63,16),o(_),I(()=>{ee(_,"id",(e(i),n(()=>e(i).key+"-create"))),ee(_,"name",(e(i),n(()=>e(i).key))),_.required=(e(i),n(()=>e(i).required))}),st(_,()=>e(v)[e(i).key],P=>Pe(v,e(v)[e(i).key]=P)),h(b,_)},z=b=>{var _=Ya();Oe(_),I(()=>{ee(_,"id",(e(i),n(()=>e(i).key+"-create"))),ee(_,"name",(e(i),n(()=>e(i).key))),ee(_,"type",(e(i),n(()=>e(i).type||"text"))),_.required=(e(i),n(()=>e(i).required)),ee(_,"placeholder",(e(i),n(()=>e(i).placeholder)))}),Ne(_,()=>e(v)[e(i).key],Y=>Pe(v,e(v)[e(i).key]=Y)),h(b,_)};w(()=>V(he,b=>{e(i),n(()=>e(i).options)?b(se):b(z,!1)}),"if",ve,54,12)}o(k),I(()=>{ee(te,"for",(e(i),n(()=>e(i).key+"-create"))),oe(ye,(e(i),n(()=>e(i).label)))}),h(u,k)}),"each",ve,50,8),o(F);var L=M(F,2);w(()=>Te(L,5,()=>(de(s()),n(()=>s().slice(Math.ceil(s().length/2)))),Me,(u,i)=>{var k=$a(),te=c(k),ye=c(te,!0);o(te);var he=M(te,2);{var se=b=>{var _=Xa();I(()=>{e(v),We(()=>{e(i)})});var Y=c(_);Y.value=Y.__value="";var X=M(Y);w(()=>Te(X,1,()=>(e(i),n(()=>O(e(i).options))),Me,(P,q)=>{var Q=Wa(),W=c(Q,!0);o(Q);var re={};I(()=>{oe(W,(e(q),n(()=>e(q).label))),re!==(re=(e(q),n(()=>e(q).value)))&&(Q.value=(Q.__value=(e(q),n(()=>e(q).value)))??"")}),h(P,Q)}),"each",ve,97,16),o(_),I(()=>{ee(_,"id",(e(i),n(()=>e(i).key+"-create"))),ee(_,"name",(e(i),n(()=>e(i).key))),_.required=(e(i),n(()=>e(i).required))}),st(_,()=>e(v)[e(i).key],P=>Pe(v,e(v)[e(i).key]=P)),h(b,_)},z=b=>{var _=Qa();Oe(_),I(()=>{ee(_,"id",(e(i),n(()=>e(i).key+"-create"))),ee(_,"name",(e(i),n(()=>e(i).key))),ee(_,"type",(e(i),n(()=>e(i).type||"text"))),_.required=(e(i),n(()=>e(i).required)),ee(_,"placeholder",(e(i),n(()=>e(i).placeholder)))}),Ne(_,()=>e(v)[e(i).key],Y=>Pe(v,e(v)[e(i).key]=Y)),h(b,_)};w(()=>V(he,b=>{e(i),n(()=>e(i).options)?b(se):b(z,!1)}),"if",ve,88,12)}o(k),I(()=>{ee(te,"for",(e(i),n(()=>e(i).key+"-create"))),oe(ye,(e(i),n(()=>e(i).label)))}),h(u,k)}),"each",ve,84,8),o(L),o(H);var f=M(H,2),x=c(f),$=M(x,2),le=c($);{var j=u=>{var i=er();h(u,i)};w(()=>V(le,u=>{m()&&u(j)}),"if",ve,121,8)}gt(),o($),o(f),o(N),I(()=>{H.disabled=m(),$.disabled=m()}),K("click",x,()=>R("close")),K("submit",N,it(G)),h(U,N)}),$$slots:{default:!0}}),"component",ve,46,0,{componentTag:"Modal"}),Fe({...Be()})}fe[y]="src/lib/components/UpdateModal.svelte";var ar=S(T("<option> </option>"),fe[y],[[41,18]]),rr=S(T('<select class="select select-bordered w-full bg-neutral-800 border-neutral-600 text-white"><option disabled selected hidden>Válassz...</option><!></select>'),fe[y],[[33,14,[[39,16]]]]),sr=S(T('<input class="input input-bordered w-full bg-neutral-800 border-neutral-600 text-white"/>'),fe[y],[[45,14]]),nr=S(T('<div><label class="block mb-1 font-semibold"> </label> <!></div>'),fe[y],[[30,10,[[31,12]]]]),or=S(T("<option> </option>"),fe[y],[[71,18]]),lr=S(T('<select class="select select-bordered w-full bg-neutral-800 border-neutral-600 text-white"><option disabled selected hidden>Válassz...</option><!></select>'),fe[y],[[63,14,[[69,16]]]]),ir=S(T('<input class="input input-bordered w-full bg-neutral-800 border-neutral-600 text-white"/>'),fe[y],[[75,14]]),cr=S(T('<div><label class="block mb-1 font-semibold"> </label> <!></div>'),fe[y],[[60,10,[[61,12]]]]),ur=S(T('<span class="loading loading-spinner loading-sm mr-2"></span>'),fe[y],[[93,10]]),dr=S(T('<form class="space-y-4"><div class="flex flex-wrap gap-6"><div class="flex-1 min-w-[220px] space-y-4"></div> <div class="flex-1 min-w-[220px] space-y-4"></div></div> <div class="flex justify-end gap-2 pt-2"><button type="button" class="btn btn-error">Mégsem</button> <button type="submit" class="btn btn-success"><!> Mentés</button></div></form>'),fe[y],[[26,2,[[27,4,[[28,6],[58,6]]],[89,4,[[90,6],[91,6]]]]]]);function fe(t,a){De(new.target),He(a,!1,fe);let r=ne(a,"show",8,!1),l=ne(a,"title",8,"Rekord szerkesztése"),s=ne(a,"fields",24,()=>[]),g=ne(a,"initial",24,()=>({})),m=ne(a,"isLoading",8,!1);const R=Ye();let v=D({});function A(O,U){Pe(v,e(v)[U]=O.target.value)}function G(O){O.preventDefault(),R("submit",{...e(v)})}return ge(()=>de(g()),()=>{d(v,{...g()})}),$e(),Je(),w(()=>Qe(t,{get show(){return r()},get title(){return l()},$$events:{close:()=>R("close")},children:Ct(fe,(O,U)=>{var Z=dr(),N=c(Z),H=c(N);w(()=>Te(H,5,()=>(de(s()),n(()=>s().slice(0,Math.ceil(s().length/2)))),Me,(j,u)=>{var i=nr(),k=c(i),te=c(k,!0);o(k);var ye=M(k,2);{var he=z=>{var b=rr();I(()=>{e(v),We(()=>{e(u)})});var _=c(b);_.value=_.__value="";var Y=M(_);w(()=>Te(Y,1,()=>(e(u),n(()=>e(u).options)),Me,(X,P)=>{var q=ar(),Q=c(q,!0);o(q);var W={};I(()=>{oe(Q,e(P)),W!==(W=e(P))&&(q.value=(q.__value=e(P))??"")}),h(X,q)}),"each",fe,40,16),o(b),I(()=>{ee(b,"id",(e(u),n(()=>e(u).key+"-update"))),b.required=(e(u),n(()=>e(u).required))}),st(b,()=>e(v)[e(u).key],X=>Pe(v,e(v)[e(u).key]=X)),K("input",b,X=>A(X,e(u).key)),h(z,b)},se=z=>{var b=sr();Oe(b),I(()=>{ee(b,"id",(e(u),n(()=>e(u).key+"-update"))),ee(b,"type",(e(u),n(()=>e(u).type||"text"))),b.required=(e(u),n(()=>e(u).required)),ee(b,"placeholder",(e(u),n(()=>e(u).placeholder)))}),Ne(b,()=>e(v)[e(u).key],_=>Pe(v,e(v)[e(u).key]=_)),K("input",b,_=>A(_,e(u).key)),h(z,b)};w(()=>V(ye,z=>{e(u),n(()=>e(u).options)?z(he):z(se,!1)}),"if",fe,32,12)}o(i),I(()=>{ee(k,"for",(e(u),n(()=>e(u).key+"-update"))),oe(te,(e(u),n(()=>e(u).label)))}),h(j,i)}),"each",fe,29,8),o(H);var F=M(H,2);w(()=>Te(F,5,()=>(de(s()),n(()=>s().slice(Math.ceil(s().length/2)))),Me,(j,u)=>{var i=cr(),k=c(i),te=c(k,!0);o(k);var ye=M(k,2);{var he=z=>{var b=lr();I(()=>{e(v),We(()=>{e(u)})});var _=c(b);_.value=_.__value="";var Y=M(_);w(()=>Te(Y,1,()=>(e(u),n(()=>e(u).options)),Me,(X,P)=>{var q=or(),Q=c(q,!0);o(q);var W={};I(()=>{oe(Q,e(P)),W!==(W=e(P))&&(q.value=(q.__value=e(P))??"")}),h(X,q)}),"each",fe,70,16),o(b),I(()=>{ee(b,"id",(e(u),n(()=>e(u).key+"-update"))),b.required=(e(u),n(()=>e(u).required))}),st(b,()=>e(v)[e(u).key],X=>Pe(v,e(v)[e(u).key]=X)),K("input",b,X=>A(X,e(u).key)),h(z,b)},se=z=>{var b=ir();Oe(b),I(()=>{ee(b,"id",(e(u),n(()=>e(u).key+"-update"))),ee(b,"type",(e(u),n(()=>e(u).type||"text"))),b.required=(e(u),n(()=>e(u).required)),ee(b,"placeholder",(e(u),n(()=>e(u).placeholder)))}),Ne(b,()=>e(v)[e(u).key],_=>Pe(v,e(v)[e(u).key]=_)),K("input",b,_=>A(_,e(u).key)),h(z,b)};w(()=>V(ye,z=>{e(u),n(()=>e(u).options)?z(he):z(se,!1)}),"if",fe,62,12)}o(i),I(()=>{ee(k,"for",(e(u),n(()=>e(u).key+"-update"))),oe(te,(e(u),n(()=>e(u).label)))}),h(j,i)}),"each",fe,59,8),o(F),o(N);var L=M(N,2),f=c(L),x=M(f,2),$=c(x);{var le=j=>{var u=ur();h(j,u)};w(()=>V($,j=>{m()&&j(le)}),"if",fe,92,8)}gt(),o(x),o(L),o(Z),I(()=>x.disabled=m()),K("click",f,()=>R("close")),K("submit",Z,it(G)),h(O,Z)}),$$slots:{default:!0}}),"component",fe,25,0,{componentTag:"Modal"}),Fe({...Be()})}we[y]="src/lib/components/AdminModal.svelte";var vr=S(T('<div class="alert alert-error"> </div>'),we[y],[[105,10]]),fr=S(T('<div class="text-sm opacity-80">Betöltés…</div>'),we[y],[[109,10]]),br=S(T("<option> </option>"),we[y],[[136,26]]),pr=S(T(`<tr class="border-t border-neutral-800"><td class="p-2"> </td><td class="p-2"> </td><td class="p-2"><select class="select select-sm select-bordered w-40
                               bg-neutral-800 text-neutral-100 border-neutral-600
                               focus:outline-none focus:ring-2 focus:ring-amber-400 focus:border-amber-400"></select></td><td class="p-2"> </td><td class="p-2 text-right"><button class="btn btn-xs bg-red-500 hover:bg-red-600" title="Törlés">🗑️</button></td></tr>`),we[y],[[124,18,[[125,20],[126,20],[127,20,[[128,22]]],[140,20],[141,20,[[142,22]]]]]]),gr=S(T('<tr><td colspan="5" class="p-4 text-center opacity-70">Nincs felhasználó.</td></tr>'),we[y],[[151,18,[[152,20]]]]),hr=S(T('<div class="overflow-auto rounded-lg border border-neutral-800"><table class="w-full text-sm"><thead class="sticky top-0 bg-neutral-800"><tr><th class="p-2 text-left">ID</th><th class="p-2 text-left">Felhasználónév</th><th class="p-2 text-left">Szerep</th><th class="p-2 text-left">Létrehozva</th><th class="p-2 text-right">Művelet</th></tr></thead><tbody><!><!></tbody></table></div>'),we[y],[[111,10,[[112,12,[[113,14,[[114,16,[[115,18],[116,18],[117,18],[118,18],[119,18]]]]],[122,14]]]]]]),mr=S(T('<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/60" aria-modal="true" role="dialog"><div class="mx-4 w-full max-w-4xl rounded-xl bg-neutral-900 shadow-xl"><div class="flex items-center justify-between border-b border-neutral-800 p-4"><h2 class="text-lg font-semibold">Admin panel – Felhasználók</h2> <button class="btn btn-xs">X</button></div> <div class="space-y-4 p-4"><!> <!></div> <div class="border-t border-neutral-800 p-4 text-right"><button class="btn btn-primary">Bezár</button></div></div></div>'),we[y],[[90,2,[[97,4,[[98,6,[[99,8],[100,8]]],[103,6],[161,6,[[162,8]]]]]]]]);function we(t,a){De(new.target),He(a,!1,we);let r=ne(a,"show",12,!1);const l=Ye();let s=D(!1),g=D(""),m=D([]);async function R(L,f){const x=(await ae(fetch(L,f)))(),$=(await ae(x.text()))();let le={};try{le=$?JSON.parse($):{}}catch{throw new Error($||`${x.status} ${x.statusText}`)}if(!x.ok||C(le?.success,!1))throw new Error(le?.error||`${x.status} ${x.statusText}`);return le}let v=D(!1);async function A(){d(s,!0),d(g,"");try{const L=(await ae(R("/api/admin/users")))();d(m,L.users??[])}catch(L){d(g,L.message),ke(e(g),"error")}finally{d(s,!1)}}async function G(L,f){try{(await ae(R(`/api/admin/users/${L}/role`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({role:f})})))(),ke("Szerepkör sikeresen frissítve!","success"),(await ae(A()))(),l("changed")}catch(x){ke(x.message||"Sikertelen mentés","error")}}async function O(L,f){if(confirm(`Biztosan törlöd: ${f}?`))try{(await ae(R(`/api/admin/users/${L}`,{method:"DELETE"})))(),ke("Felhasználó törölve","success"),(await ae(A()))(),l("changed")}catch(x){ke(x.message||"Sikertelen törlés","error")}}function U(){r(!1),l("close")}const Z=["user","admin"];ge(()=>(de(r()),e(v)),()=>{r()&&!e(v)&&(d(v,!0),A())}),ge(()=>(de(r()),e(v)),()=>{!r()&&e(v)&&d(v,!1)}),$e(),Je();var N=Ee(),H=ze(N);{var F=L=>{var f=mr(),x=c(f),$=c(x),le=M(c($),2);o($);var j=M($,2),u=c(j);{var i=z=>{var b=vr(),_=c(b,!0);o(b),I(()=>oe(_,e(g))),h(z,b)};w(()=>V(u,z=>{e(g)&&z(i)}),"if",we,104,8)}var k=M(u,2);{var te=z=>{var b=fr();h(z,b)},ye=z=>{var b=hr(),_=c(b),Y=M(c(_)),X=c(Y);w(()=>Te(X,1,()=>e(m),Me,(Q,W,re)=>{var B=pr(),ce=c(B),Ve=c(ce,!0);o(ce);var Re=M(ce),Ze=c(Re,!0);o(Re);var pe=M(Re),me=c(pe);I(()=>{e(W),We(()=>{})}),w(()=>Te(me,5,()=>Z,Me,(ue,Ae)=>{var je=br(),et=c(je,!0);o(je);var Ce={};I(()=>{oe(et,e(Ae)),Ce!==(Ce=e(Ae))&&(je.value=(je.__value=e(Ae))??"")}),h(ue,je)}),"each",we,135,24),o(me),o(pe);var Le=M(pe),qe=c(Le,!0);o(Le);var Ke=M(Le),_e=c(Ke);o(Ke),o(B),I(ue=>{oe(Ve,(e(W),n(()=>e(W).id))),oe(Ze,(e(W),n(()=>e(W).username))),oe(qe,ue)},[()=>(e(W),n(()=>new Date(e(W).createdAt).toLocaleString()))]),st(me,()=>e(W).role,ue=>(e(W).role=ue,We(()=>e(m)))),K("change",me,ue=>G(e(W).id,ue.currentTarget.value)),K("click",_e,()=>O(e(W).id,e(W).username)),h(Q,B)}),"each",we,123,16);var P=M(X);{var q=Q=>{var W=gr();h(Q,W)};w(()=>V(P,Q=>{e(m),n(()=>C(e(m).length,0))&&Q(q)}),"if",we,150,16)}o(Y),o(_),o(b),h(z,b)};w(()=>V(k,z=>{e(s)?z(te):z(ye,!1)}),"if",we,108,8)}o(j);var he=M(j,2),se=c(he);o(he),o(x),o(f),K("click",le,U),K("click",se,U),K("click",x,ht(function(z){mt.call(this,a,z)})),K("click",f,U),h(L,f)};w(()=>V(H,L=>{r()&&L(F)}),"if",we,85,0)}return h(t,N),Fe({...Be()})}be[y]="src/routes/+page.svelte";var _r=S(T('<button class="flex items-center gap-2 rounded-full border border-blue-900 bg-gradient-to-r from-blue-700 to-blue-600 px-4 py-2 font-semibold shadow-lg transition hover:from-blue-800 hover:to-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-400" title="Új felvétel"><svg class="h-5 w-5" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M12 4v16m8-8H4"></path></svg> Felvétel</button>'),be[y],[[202,10,[[205,12,[[206,14]]]]]]),yr=S(T('<button class="flex items-center gap-2 rounded-full border border-amber-900 bg-gradient-to-r from-amber-700 to-amber-600 px-4 py-2 font-semibold shadow-lg transition hover:from-amber-800 hover:to-amber-700 focus:outline-none focus:ring-2 focus:ring-amber-400" title="Admin panel"><svg class="h-5 w-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M12 3l7 4v5c0 5-3.5 7.5-7 9-3.5-1.5-7-4-7-9V7l7-4z"></path></svg> Admin</button>'),be[y],[[213,10,[[216,12,[[217,14]]]]]]),kr=S(T('<button class="flex items-center gap-2 rounded-full border border-neutral-900 bg-gradient-to-r from-neutral-800 to-neutral-700 px-4 py-2 font-semibold shadow-lg transition hover:from-neutral-900 hover:to-neutral-800 focus:outline-none focus:ring-2 focus:ring-red-400" title="Kijelentkezés"><svg class="h-5 w-5 text-red-400" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><circle cx="12" cy="8" r="4"></circle><path stroke-linecap="round" stroke-linejoin="round" d="M16 16v1a4 4 0 01-8 0v-1"></path></svg> <span>Kijelentkezés</span> <span class="ml-2 rounded-full bg-red-700 px-2 py-1 text-xs font-bold"> </span></button>'),be[y],[[224,10,[[227,12,[[228,14],[229,14]]],[231,12],[232,12]]]]),xr=S(T('<button class="flex items-center gap-2 rounded-full border border-blue-900 bg-gradient-to-r from-blue-700 to-blue-600 px-4 py-2 font-semibold shadow-lg transition hover:from-blue-800 hover:to-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-400" title="Bejelentkezés / Regisztráció"><svg class="h-5 w-5" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M5 12h14M12 5v14"></path></svg> Bejelentkezés / Regisztráció</button> <!>',1),be[y],[[235,10,[[238,12,[[239,14]]]]]]),wr=S(T('<div class="m-0 flex h-screen w-screen flex-col bg-neutral-950 text-white"><header class="w-full px-4 py-4"><div class="flex w-full items-center gap-4"><h1 class="text-3xl font-extrabold tracking-tight">Állománytábla</h1> <div class="flex-1 flex items-center justify-center gap-3"><!> <span class="text-xs font-semibold text-blue-300"> </span></div> <div class="flex items-center gap-3"><!> <!> <!></div></div></header> <main class="flex-1 min-h-0 overflow-auto px-2"><!></main></div> <!> <!> <!>',1),be[y],[[190,0,[[191,2,[[192,4,[[193,6],[195,6,[[197,8]]],[200,6]]]]],[251,2]]]]);function be(t,a){De(new.target),He(a,!1,be);const r=D(),l=D(),s=D(),g=D(),m=D(),R=D();let v=ne(a,"data",8),A=D(""),G=D(null),O=D(null),U=D(!1),Z=D(!1),N=D(!1),H=D(!1),F=D(null),L=D(!1);async function f(){try{const p=(await ae(fetch("/api/auth/me")))();if(p.ok){const{user:E}=(await ae(p.json()))();d(O,E??null),d(G,E?.role??null)}else d(O,null),d(G,null)}catch{d(O,null),d(G,null)}}jt(f);const x=()=>{d(U,!0)},$=()=>{d(U,!1)},le=async()=>{d(U,!1),(await ae(f()))(),ke("Sikeres bejelentkezés 🎉","success")};async function j(){try{(await ae(fetch("/api/auth/logout",{method:"POST"})))()}catch{}d(Z,!1),(await ae(f()))(),ke("Kijelentkezve","info")}function u(p){if(!p)return[];if(C(typeof p,"object")&&!Array.isArray(p)){const E=[];return p.role&&E.push(p.role),p.roles&&E.push(...Array.isArray(p.roles)?p.roles:[p.roles]),E.map(String)}return Array.isArray(p)?p.map(String):[String(p)]}const i=[{key:"Név",label:"Név",required:!0,placeholder:"Add meg a nevet"},{key:"Rendfokozat",label:"Rendfokozat",required:!0,placeholder:"Pl. Őrmester",options:["Akadémista","Őrmester","Törzsőrmester","Főtörzsőrmester","Zászlós","Törzszászlós","Főtörzszászlós","Hadnagy","Főhadnagy","Százados","Őrnagy","Alezredes","Ezredes","Dandártábornok","Vezérőrnagy","Altábornagy"]},{key:"Beosztás",label:"Beosztás",required:!1,options:["Vezérkar","Vezérkar helyettes","Osztályvezető","Ov. helyettes","Járőr"]},{key:"Osztályok",label:"Osztályok",required:!1,options:["HR","Nyomozó","Helyszínelő","Kiképző","BKO"]},{key:"Egységszám",label:"Egységszám",required:!1},{key:"Telefonszám",label:"Telefonszám",required:!1},{key:"discord ID",label:"Discord ID",required:!1},{key:"Csatlakozás",label:"Csatlakozás",required:!1,type:"date"},{key:"Előléptetve",label:"Előléptetve",required:!1,type:"date"},{key:"Aktivitás",label:"Aktivitás",required:!1,options:["Aktív","Inaktív"]},{key:"Inaktivitás kezdete",label:"Inaktivitás kezdete",required:!1,type:"date"},{key:"Helikopteres Vizsga",label:"Helikopteres Vizsga",required:!1,options:["Van","Nincs"]}],k=Object.fromEntries(i.map(p=>[p.key,""]));async function te(p){const E=(await ae(p.text()))();try{return E?JSON.parse(E):{}}catch{throw new Error(E||`${p.status} ${p.statusText}`)}}async function ye(p){d(L,!0);try{const E=p.detail,ie=new FormData;for(const[Ue,ut]of Object.entries(E))e(s).includes(Ue)&&ie.append(Ue,ut??"");const xe=(await ae(fetch("?/add",{method:"POST",body:ie})))(),Ie=(await ae(te(xe)))();if(!xe.ok||C(Ie?.success,!1))throw new Error(Ie?.error||"Sikertelen felvétel");ke("Rekord létrehozva ✅","success"),d(N,!1),(await ae(lt()))()}catch(E){ke("Hiba felvétel közben: "+(E?.message||"Ismeretlen hiba"),"error")}finally{d(L,!1)}}function he(p){const E=p?.detail??null;E&&(d(F,{...E}),d(H,!0))}async function se(p){if(e(F)){d(L,!0);try{const E=p.detail,ie=new FormData;ie.append("id",String(e(F)["#"]));for(const[Ue,ut]of Object.entries(E))C(Ue,"id",!1)&&ie.append(Ue,ut??"");const xe=(await ae(fetch("?/update",{method:"POST",body:ie})))(),Ie=(await ae(te(xe)))();if(!xe.ok||C(Ie?.success,!1))throw new Error(Ie?.error||"Sikertelen módosítás");ke("Rekord frissítve ✨","success"),d(H,!1),d(F,null),(await ae(lt()))()}catch(E){ke("Hiba a módosítás során: "+(E?.message||"Ismeretlen hiba"),"error")}finally{d(L,!1)}}}async function z(p){const E=p.detail;if(!(C(typeof window,"undefined",!1)&&!confirm(`Biztosan törlöd: ${E.Név}?`)))try{const ie=new FormData;ie.append("id",String(E["#"]));const xe=(await ae(fetch("?/delete",{method:"POST",body:ie})))(),Ie=(await ae(te(xe)))();if(!xe.ok||C(Ie?.success,!1))throw new Error(Ie?.error||"Sikertelen törlés");ke("Rekord törölve 🗑️","success"),(await ae(lt()))()}catch(ie){ke("Hiba törlés közben: "+(ie?.message||"Ismeretlen hiba"),"error")}}function b(p){C(p.key,"Escape")&&(e(U)&&d(U,!1),e(N)&&d(N,!1),e(H)&&(d(H,!1),d(F,null)),e(Z)&&d(Z,!1))}ge(()=>e(G),()=>{d(r,u(e(G)).map(p=>p.toLowerCase().trim()).some(p=>C(p,"admin")||C(p,"hr")||p.includes("admin")||p.includes("hr")))}),ge(()=>de(v()),()=>{d(l,Array.isArray(v())?v():v()?.data??[])}),ge(()=>e(l),()=>{d(s,e(l)?.[0]??[])}),ge(()=>e(l),()=>{d(g,e(l)?.slice(1)??[])}),ge(()=>(e(A),e(g)),()=>{d(m,e(A)?e(g).filter(p=>p.some(E=>(E??"").toString().toLowerCase().includes(e(A).toLowerCase()))):e(g))}),ge(()=>(e(s),e(m)),()=>{d(R,e(s).length?[e(s),...e(m)]:[])}),$e(),Je();var _=wr();K("keydown",ta,b);var Y=ze(_),X=c(Y),P=c(X),q=M(c(P),2),Q=c(q);w(()=>nt(Q,{placeholder:"Keresés…",get value(){return e(A)},set value(p){d(A,p)},$$legacy:!0}),"component",be,196,8,{componentTag:"SearchInput"});var W=M(Q,2),re=c(W);o(W),o(q);var B=M(q,2),ce=c(B);{var Ve=p=>{var E=_r();K("click",E,()=>d(N,!0)),h(p,E)};w(()=>V(ce,p=>{e(r)&&p(Ve)}),"if",be,201,8)}var Re=M(ce,2);{var Ze=p=>{var E=yr();K("click",E,()=>d(Z,!0)),h(p,E)};w(()=>V(Re,p=>{e(O),n(()=>C(e(O)?.role,"admin"))&&p(Ze)}),"if",be,212,8)}var pe=M(Re,2);{var me=p=>{var E=kr(),ie=M(c(E),4),xe=c(ie,!0);o(ie),o(E),I(()=>oe(xe,(e(O),n(()=>e(O).username)))),K("click",E,j),h(p,E)},Le=p=>{var E=xr(),ie=ze(E),xe=M(ie,2);{var Ie=Ue=>{w(()=>Se(Ue,{get show(){return e(U)},$$events:{close:$,login:le}}),"component",be,244,12,{componentTag:"AuthModal"})};w(()=>V(xe,Ue=>{e(U)&&Ue(Ie)}),"if",be,243,10)}K("click",ie,x),h(p,E)};w(()=>V(pe,p=>{e(O)?p(me):p(Le,!1)}),"if",be,223,8)}o(B),o(P),o(X);var qe=M(X,2),Ke=c(qe);w(()=>ct(Ke,{get data(){return e(R)},get userRole(){return e(G)},$$events:{edit:he,delete:z}}),"component",be,252,4,{componentTag:"StaffTable"}),o(qe),o(Y);var _e=M(Y,2);{var ue=p=>{w(()=>ve(p,{get show(){return e(N)},title:"Új alkalmazott",get fields(){return i},get initial(){return k},get isLoading(){return e(L)},$$events:{close:()=>d(N,!1),submit:ye}}),"component",be,262,2,{componentTag:"CreateModal"})};w(()=>V(_e,p=>{e(N)&&p(ue)}),"if",be,261,0)}var Ae=M(_e,2);{var je=p=>{{let E=yt(()=>(e(F),n(()=>e(F)?`Szerkesztés: ${e(F).Név}`:"Szerkesztés"))),ie=yt(()=>e(F)??{});w(()=>fe(p,{get show(){return e(H)},get title(){return e(E)},get fields(){return i},get initial(){return e(ie)},get isLoading(){return e(L)},$$events:{close:()=>{d(H,!1),d(F,null)},submit:se}}),"component",be,274,2,{componentTag:"UpdateModal"})}};w(()=>V(Ae,p=>{e(H)&&p(je)}),"if",be,273,0)}var et=M(Ae,2);{var Ce=p=>{w(()=>we(p,{get show(){return e(Z)},$$events:{close:()=>d(Z,!1),changed:()=>lt()}}),"component",be,286,2,{componentTag:"AdminModal"})};w(()=>V(et,p=>{e(O),n(()=>C(e(O)?.role,"admin"))&&p(Ce)}),"if",be,285,0)}return I(()=>oe(re,`${e(m),n(()=>e(m).length)??""} találat`)),h(t,_),Fe({...Be()})}export{be as component};
